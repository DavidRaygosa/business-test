"use strict";(self.webpackChunkbusiness=self.webpackChunkbusiness||[]).push([[148],{2148:(D,g,c)=>{c.r(g),c.d(g,{ClientModule:()=>B});var l=c(6895),m=c(9965);var _=c(8766),t=c(8256),d=c(4120),h=c(4838),u=c(6618);function x(i,o){1&i&&(t.TgZ(0,"div",8)(1,"span",9),t._uU(2,"Por el momento no hay ningun articulo disponible"),t.qZA()())}function I(i,o){if(1&i){const e=t.EpF();t.TgZ(0,"div",23)(1,"button",24),t.NdJ("click",function(){t.CHM(e);const s=t.oxw(2).$implicit,r=t.oxw(4);return t.KtG(r.handleRemoveQuantity(s))}),t._uU(2,"-"),t.qZA(),t._UZ(3,"input",25),t.TgZ(4,"button",24),t.NdJ("click",function(){t.CHM(e);const s=t.oxw(2).$implicit,r=t.oxw(4);return t.KtG(r.handleAddQuantity(s))}),t._uU(5,"+"),t.qZA()()}if(2&i){const e=t.oxw(2).$implicit;t.xp6(1),t.Q6J("disabled",e.quantity<=1),t.xp6(2),t.s9C("value",e.quantity),t.xp6(1),t.Q6J("disabled",e.quantity>=e.stock)}}function b(i,o){if(1&i){const e=t.EpF();t.TgZ(0,"button",26),t.NdJ("click",function(){t.CHM(e);const s=t.oxw(2).$implicit,r=t.oxw(4);return t.KtG(r.onAddToShoppingCart(s))}),t._uU(1,"A\xf1adir al carrito"),t.qZA()}}function C(i,o){if(1&i&&(t.TgZ(0,"div",20),t.YNc(1,I,6,3,"div",21),t.YNc(2,b,2,0,"button",22),t.qZA()),2&i){const e=t.oxw().$implicit;t.xp6(1),t.Q6J("ngIf",e.quantity),t.xp6(1),t.Q6J("ngIf",e.stock>0)}}function Z(i,o){1&i&&(t.TgZ(0,"button",27),t._uU(1,"Sin stock"),t.qZA())}function v(i,o){if(1&i&&(t.TgZ(0,"li")(1,"div",12),t._UZ(2,"img",13),t.TgZ(3,"div",14)(4,"h5",15),t._uU(5),t.qZA(),t.TgZ(6,"p",16),t._uU(7),t.qZA()(),t.TgZ(8,"div",17)(9,"span",16),t._uU(10),t.ALo(11,"currency"),t.qZA(),t.TgZ(12,"span",16),t._uU(13),t.qZA()(),t.YNc(14,C,3,2,"div",18),t.YNc(15,Z,2,0,"button",19),t.qZA()()),2&i){const e=o.$implicit;t.xp6(2),t.s9C("src",e.image,t.LSH),t.xp6(3),t.Oqu(e.code),t.xp6(2),t.Oqu(e.description),t.xp6(3),t.Oqu(t.lcZ(11,7,e.price)),t.xp6(3),t.hij("Disponibles: ",e.stock,""),t.xp6(1),t.Q6J("ngIf",e.stock),t.xp6(1),t.Q6J("ngIf",!e.stock)}}function T(i,o){if(1&i&&(t.TgZ(0,"ul",10),t.YNc(1,v,16,9,"li",11),t.qZA()),2&i){const e=t.oxw(3);t.xp6(1),t.Q6J("ngForOf",e.Items)}}function A(i,o){if(1&i&&(t.TgZ(0,"main",5),t.YNc(1,x,3,0,"div",6),t.YNc(2,T,2,1,"ul",7),t.qZA()),2&i){const e=t.oxw(2);t.xp6(1),t.Q6J("ngIf",e.Items.length<=0),t.xp6(1),t.Q6J("ngIf",e.Items.length>0)}}function k(i,o){if(1&i&&(t.TgZ(0,"div"),t.YNc(1,A,3,2,"main",4),t.qZA()),2&i){const e=t.oxw();t.xp6(1),t.Q6J("ngIf",e.permissions.includes(e.PermissionEnum.Item_Get_All))}}function q(i,o){1&i&&(t.TgZ(0,"div",28),t._UZ(1,"skeleton-block",29)(2,"skeleton-block",29)(3,"skeleton-block",29)(4,"skeleton-block",29)(5,"skeleton-block",29)(6,"skeleton-block",29)(7,"skeleton-block",29)(8,"skeleton-block",29)(9,"skeleton-block",29)(10,"skeleton-block",29),t.qZA())}function S(i,o){if(1&i&&(t.TgZ(0,"div",30)(1,"span"),t._uU(2),t.qZA()()),2&i){const e=t.oxw();t.xp6(2),t.Oqu(e.errorMessage)}}function y(i,o){if(1&i&&(t.TgZ(0,"div",31)(1,"span"),t._uU(2),t.qZA()()),2&i){const e=t.oxw();t.xp6(2),t.Oqu(e.alertMessage)}}let w=(()=>{class i{constructor(e,n,s){this.LoginService=e,this.Router=n,this.ApiBusinessService=s,this.permissions=[""],this.PermissionEnum=_.y,this.error=!1,this.errorMessage="",this.alert=!1,this.alertMessage="",this.loadingItems=!0,this.Items=[]}ngOnInit(){this.LoginService.currentPermissions.subscribe(e=>{this.permissions=e,this.permissions.length>1&&!this.permissions.includes(_.y.Store_Admin)&&this.Router.navigate([""])}),this.getItems()}getItems(){this.loadingItems=!0,this.ApiBusinessService.GetItems().subscribe({next:e=>this.handleNextItems(e),error:e=>this.handleErrorItems(e)})}handleNextItems(e){this.Items=e,this.Items.map(n=>n.quantity=1),this.loadingItems=!1}handleErrorItems(e){this.loadingItems=!1,this.showErrorAlert(e.error)}handleRemoveQuantity(e){!e||!e.quantity||e.quantity<=1||e.quantity--}handleAddQuantity(e){!e||!e.quantity||!e.stock||e.quantity>=e.stock||e.quantity++}onAddToShoppingCart(e){if(!e)return;const n={itemId:e.id,quantity:e.quantity},s=JSON.parse(localStorage.getItem("SHOPPINGCART"));if(!s)return localStorage.setItem("SHOPPINGCART",JSON.stringify([n])),void this.showAlert(`El articulo ${e.code} ha sido agregado exitosamente al carrito de compras`);s.push(n),localStorage.setItem("SHOPPINGCART",JSON.stringify(s)),this.showAlert(`El articulo ${e.code} ha sido agregado exitosamente al carrito de compras`)}hideAlert(){this.alert=!1,this.alertMessage=""}showAlert(e){this.alert=!0,this.alertMessage=e,setTimeout(()=>{this.hideAlert()},5e3)}hideError(){this.error=!1,this.errorMessage=""}showErrorAlert(e){this.error=!0,this.errorMessage=e.Message?e.Message||"Unknown error":e||"Unknown error"}}return i.\u0275fac=function(e){return new(e||i)(t.Y36(d.r),t.Y36(m.F0),t.Y36(h.G))},i.\u0275cmp=t.Xpm({type:i,selectors:[["app-items"]],decls:4,vars:4,consts:[[4,"ngIf"],["class","d-flex flex-wrap col-12 p-4",4,"ngIf"],["class","alert alert-danger fixed-bottom col-12 text-center","role","alert",4,"ngIf"],["class","alert alert-primary fixed-bottom col-12 text-center","role","alert",4,"ngIf"],["class","col-12 p-4",4,"ngIf"],[1,"col-12","p-4"],["class","col-12 text-center",4,"ngIf"],["class","list-unstyled d-flex flex-wrap",4,"ngIf"],[1,"col-12","text-center"],[1,"text-muted"],[1,"list-unstyled","d-flex","flex-wrap"],[4,"ngFor","ngForOf"],[1,"card","me-4","mb-2","p-2","shadow",2,"width","18rem","height","35rem"],["height","250px",1,"card-img-top",3,"src"],[1,"card-body","overflow-auto","mb-2"],[1,"card-title"],[1,"card-text"],[1,"col-12","d-flex","flex-column","align-items-end","mb-2"],["class","col-12",4,"ngIf"],["class","btn btn-primary col-12","disabled","",4,"ngIf"],[1,"col-12"],["class","counter mb-2",4,"ngIf"],["class","btn btn-primary col-12",3,"click",4,"ngIf"],[1,"counter","mb-2"],[1,"btn","btn-primary","p-2",3,"disabled","click"],["type","text","disabled","",3,"value"],[1,"btn","btn-primary","col-12",3,"click"],["disabled","",1,"btn","btn-primary","col-12"],[1,"d-flex","flex-wrap","col-12","p-4"],["effect","wave","width","320px","height","500px",1,"mb-4","me-4"],["role","alert",1,"alert","alert-danger","fixed-bottom","col-12","text-center"],["role","alert",1,"alert","alert-primary","fixed-bottom","col-12","text-center"]],template:function(e,n){1&e&&(t.YNc(0,k,2,1,"div",0),t.YNc(1,q,11,0,"div",1),t.YNc(2,S,3,1,"div",2),t.YNc(3,y,3,1,"div",3)),2&e&&(t.Q6J("ngIf",!n.loadingItems),t.xp6(1),t.Q6J("ngIf",n.loadingItems),t.xp6(1),t.Q6J("ngIf",n.error),t.xp6(1),t.Q6J("ngIf",n.alert))},dependencies:[l.sg,l.O5,u.Gy,l.H9],styles:[".counter[_ngcontent-%COMP%]{width:100%;display:flex;align-items:center;justify-content:flex-end}.counter[_ngcontent-%COMP%]   input[_ngcontent-%COMP%]{width:20%;text-align:center;color:#0052cc;border:0}"]}),i})();var N=c(2687),f=c(2216);function U(i,o){if(1&i&&t._UZ(0,"img",21),2&i){const e=t.oxw().$implicit;t.s9C("src",e.image,t.LSH)}}function J(i,o){if(1&i&&(t.TgZ(0,"span"),t._uU(1),t.qZA()),2&i){const e=t.oxw().$implicit;t.xp6(1),t.Oqu(e.stock<=0?"Sin stock":e.stock)}}function M(i,o){1&i&&(t.TgZ(0,"span"),t._uU(1,"Error"),t.qZA())}function O(i,o){if(1&i){const e=t.EpF();t.TgZ(0,"tr")(1,"th",15),t._uU(2),t.qZA(),t.TgZ(3,"td",16),t._uU(4),t.qZA(),t.TgZ(5,"td"),t._uU(6),t.ALo(7,"currency"),t.qZA(),t.TgZ(8,"td"),t.YNc(9,U,1,1,"img",17),t.qZA(),t.TgZ(10,"td"),t._uU(11),t.qZA(),t.TgZ(12,"td"),t.YNc(13,J,2,1,"span",18),t.YNc(14,M,2,0,"span",18),t.qZA(),t.TgZ(15,"td")(16,"button",19),t.NdJ("click",function(){const r=t.CHM(e).$implicit,p=t.oxw(3);return t.KtG(p.onDeleteItem(r))}),t._UZ(17,"fa-icon",20),t.qZA()()()}if(2&i){const e=o.$implicit,n=t.oxw(3);t.xp6(2),t.Oqu(e.code),t.xp6(2),t.Oqu(e.description),t.xp6(2),t.Oqu(t.lcZ(7,8,e.price)),t.xp6(3),t.Q6J("ngIf",e.image),t.xp6(2),t.Oqu(e.quantity),t.xp6(2),t.Q6J("ngIf",e.stock),t.xp6(1),t.Q6J("ngIf",!e.stock),t.xp6(3),t.Q6J("icon",n.faXmark)}}function Q(i,o){1&i&&(t.TgZ(0,"span"),t._uU(1,"Realizar pedido"),t.qZA())}function Y(i,o){1&i&&(t.TgZ(0,"div",24)(1,"span",25),t._uU(2,"Loading..."),t.qZA()())}function E(i,o){if(1&i){const e=t.EpF();t.TgZ(0,"button",22),t.NdJ("click",function(){t.CHM(e);const s=t.oxw(3);return t.KtG(s.onOrder())}),t.YNc(1,Q,2,0,"span",18),t.YNc(2,Y,3,0,"div",23),t.qZA()}if(2&i){const e=t.oxw(3);t.Q6J("disabled",e.creatingClientItem),t.xp6(1),t.Q6J("ngIf",!e.creatingClientItem),t.xp6(1),t.Q6J("ngIf",e.creatingClientItem)}}function F(i,o){if(1&i&&(t.TgZ(0,"section",7)(1,"div",8)(2,"table",9)(3,"thead",10)(4,"tr")(5,"th",11),t._uU(6,"Codigo"),t.qZA(),t.TgZ(7,"th",11),t._uU(8,"Descripci\xf3n"),t.qZA(),t.TgZ(9,"th",11),t._uU(10,"Price"),t.qZA(),t.TgZ(11,"th",11),t._uU(12,"Imagen"),t.qZA(),t.TgZ(13,"th",11),t._uU(14,"Cantidad"),t.qZA(),t.TgZ(15,"th",11),t._uU(16,"Disponibles"),t.qZA(),t.TgZ(17,"th",11),t._uU(18,"Eliminar"),t.qZA()()(),t.TgZ(19,"tbody"),t.YNc(20,O,18,10,"tr",12),t.qZA()()(),t.TgZ(21,"div",13),t._UZ(22,"hr",7),t.TgZ(23,"h4"),t._uU(24,"Total"),t.qZA(),t.TgZ(25,"span",2),t._uU(26),t.ALo(27,"currency"),t.qZA(),t.YNc(28,E,3,3,"button",14),t.qZA()()),2&i){const e=t.oxw(2);t.xp6(20),t.Q6J("ngForOf",e.Items),t.xp6(6),t.Oqu(t.lcZ(27,3,e.TotalAmount)),t.xp6(2),t.Q6J("ngIf",e.permissions.includes(e.PermissionEnum.ClientItem_Create))}}function P(i,o){1&i&&(t.TgZ(0,"div",26),t._UZ(1,"skeleton-block",27)(2,"skeleton-block",28)(3,"skeleton-block",28)(4,"skeleton-block",28)(5,"skeleton-block",28)(6,"skeleton-block",28)(7,"skeleton-block",28)(8,"skeleton-block",28),t.qZA())}function G(i,o){if(1&i&&(t.TgZ(0,"div",29)(1,"span"),t._uU(2),t.qZA()()),2&i){const e=t.oxw(2);t.xp6(2),t.Oqu(e.errorMessage)}}function $(i,o){if(1&i&&(t.TgZ(0,"div",30)(1,"span"),t._uU(2),t.qZA()()),2&i){const e=t.oxw(2);t.xp6(2),t.Oqu(e.alertMessage)}}function H(i,o){if(1&i&&(t.TgZ(0,"main",1)(1,"h3",2),t._uU(2,"Carrito de compras"),t.qZA(),t._UZ(3,"hr"),t.YNc(4,F,29,5,"section",3),t.YNc(5,P,9,0,"div",4),t.YNc(6,G,3,1,"div",5),t.YNc(7,$,3,1,"div",6),t.qZA()),2&i){const e=t.oxw();t.xp6(4),t.Q6J("ngIf",!e.loadingItems),t.xp6(1),t.Q6J("ngIf",e.loadingItems),t.xp6(1),t.Q6J("ngIf",e.error),t.xp6(1),t.Q6J("ngIf",e.alert)}}const L=[{path:"",component:w},{path:"shoppingcart",component:(()=>{class i{constructor(e,n,s){this.LoginService=e,this.Router=n,this.ApiBusinessService=s,this.faXmark=N.g82,this.permissions=[""],this.PermissionEnum=_.y,this.error=!1,this.errorMessage="",this.alert=!1,this.alertMessage="",this.loadingItems=!0,this.creatingClientItem=!1,this.ShoppingCartItems=[],this.Items=[],this.TotalAmount=0}ngOnInit(){this.LoginService.currentPermissions.subscribe(n=>{this.permissions=n,this.permissions.length>1&&!this.permissions.includes(_.y.ClientItem_Get_All)&&this.Router.navigate([""])});const e=JSON.parse(localStorage.getItem("SHOPPINGCART"));e&&(this.ShoppingCartItems=e),this.getItems()}getItems(){this.Items=[],this.TotalAmount=0,0!=this.ShoppingCartItems.length?(this.loadingItems=!0,this.hideError(),this.ShoppingCartItems.map(e=>{let n=this.ApiBusinessService.getItem(Number(e.itemId)).subscribe({next:s=>this.handleNextItem(s,n),error:s=>this.handleErrorItem(s,n)})})):this.loadingItems=!1}handleNextItem(e,n){const s=this.ShoppingCartItems.find(r=>r.itemId==e.id);e.quantity=s?.quantity,e.stock&&e.quantity&&e.price&&e.stock>=e.quantity&&(this.TotalAmount+=e.quantity*e.price),this.Items.push(e),this.loadingItems=!1,n.unsubscribe()}handleErrorItem(e,n){this.loadingItems=!1,this.showErrorAlert(e.error),n.unsubscribe()}onOrder(){0!=this.Items.length&&this.Items.map((e,n)=>{if(e.stock&&e.quantity&&e.stock>=e.quantity){const s={itemId:e.id,quantity:e.quantity};this.creatingClientItem=!0,this.hideAlert();let r=this.ApiBusinessService.createClientItem(s).subscribe({next:p=>this.handleNextOrder(p,r,this.Items.length,n),error:p=>this.handleErrorOrder(p,r)})}})}handleNextOrder(e,n,s,r){this.creatingClientItem=!1,s>=r&&(this.showAlert("\xa1Orden solicitada exitosamente!"),localStorage.setItem("SHOPPINGCART",JSON.stringify([])),this.ShoppingCartItems=[],this.getItems()),n.unsubscribe()}handleErrorOrder(e,n){this.creatingClientItem=!1,this.showErrorAlert(e),n.unsubscribe()}onDeleteItem(e){if(!e)return;const n=this.ShoppingCartItems.filter(s=>s.itemId!==e.id);localStorage.setItem("SHOPPINGCART",JSON.stringify(n)),this.ShoppingCartItems=n,this.getItems()}hideAlert(){this.alert=!1,this.alertMessage=""}showAlert(e){this.alert=!0,this.alertMessage=e,setTimeout(()=>{this.hideAlert()},5e3)}hideError(){this.error=!1,this.errorMessage=""}showErrorAlert(e){this.error=!0,this.errorMessage=e.Message?e.Message||"Unknown error":e||"Unknown error"}}return i.\u0275fac=function(e){return new(e||i)(t.Y36(d.r),t.Y36(m.F0),t.Y36(h.G))},i.\u0275cmp=t.Xpm({type:i,selectors:[["app-shoppingcart"]],decls:1,vars:1,consts:[["class","col-12 p-4",4,"ngIf"],[1,"col-12","p-4"],[1,"text-muted"],["class","col-12",4,"ngIf"],["class","col-12 mt-2",4,"ngIf"],["class","alert alert-danger fixed-bottom col-12 text-center","role","alert",4,"ngIf"],["class","alert alert-primary fixed-bottom col-12 text-center","role","alert",4,"ngIf"],[1,"col-12"],[1,"table-responsive"],[1,"table"],[1,"table-dark"],["scope","col"],[4,"ngFor","ngForOf"],[1,"d-flex","flex-column","align-items-end","col-12","mt-4"],["class","btn btn-success mt-4",3,"disabled","click",4,"ngIf"],["scope","row"],[1,"text-wrap"],["width","50px","height","50px",3,"src",4,"ngIf"],[4,"ngIf"],[1,"btn","btn-danger",3,"click"],[3,"icon"],["width","50px","height","50px",3,"src"],[1,"btn","btn-success","mt-4",3,"disabled","click"],["class","spinner-grow","role","status",4,"ngIf"],["role","status",1,"spinner-grow"],[1,"visually-hidden"],[1,"col-12","mt-2"],["effect","wave","height","50px",1,"col-12","mb-4"],["effect","wave","height","30px",1,"col-12","mb-2"],["role","alert",1,"alert","alert-danger","fixed-bottom","col-12","text-center"],["role","alert",1,"alert","alert-primary","fixed-bottom","col-12","text-center"]],template:function(e,n){1&e&&t.YNc(0,H,8,4,"main",0),2&e&&t.Q6J("ngIf",n.permissions.includes(n.PermissionEnum.ClientItem_Get_All))},dependencies:[l.sg,l.O5,u.Gy,f.BN,l.H9]}),i})()}];let R=(()=>{class i{}return i.\u0275fac=function(e){return new(e||i)},i.\u0275mod=t.oAB({type:i}),i.\u0275inj=t.cJS({imports:[m.Bz.forChild(L),m.Bz]}),i})(),B=(()=>{class i{}return i.\u0275fac=function(e){return new(e||i)},i.\u0275mod=t.oAB({type:i}),i.\u0275inj=t.cJS({imports:[l.ez,R,u.s,f.uH]}),i})()}}]);